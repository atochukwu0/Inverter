\chapter{Consideraciones finales}

\section{Impacto ambiental}

El presente proyecto tiene un impacto ambiental que se concentra principalmente en la fabricación del \textit{hardware}. A pesar de que el control y \textit{firmware} del inversor tienen un impacto ambiental prácticamente nulo, la producción y ensamblaje de los componentes electrónicos son aspectos críticos a considerar.

\subsection{Fabricación de PCBs}

La fabricación de placas de circuito impreso es un proceso que requiere el uso de materiales como fibra de vidrio, cobre y resinas, cuya extracción y procesamiento pueden generar impactos ambientales significativos, especialmente si no se gestionan de manera adecuada los residuos. La generación de desechos y la emisión de productos químicos durante la fabricación de PCBs pueden contribuir a la contaminación del suelo, agua y aire. En este caso, las PCBs presentaban apilados bastante convencionales, con lo que la producción está más optimizada que para apilados más complejos con mayor número de capas o un laminado de cobre más gordo.

\subsection{Montaje y selección de materiales}

El proceso de montaje de los componentes electrónicos en las PCBs implica operaciones como la soldadura, que utiliza materiales como el estaño. Los estaños que se han usado contenían plomo, puesto que ayuda a bajar la temperatura de fusión del estaño para facilitar la soldadura. Además, la selección de materiales para los componentes electrónicos también puede influir en el impacto ambiental del proyecto. Es importante considerar la procedencia de los materiales y su impacto ambiental durante su ciclo de vida. De todas maneras, el proyecto es un prototipo y no existe ninguna intención de comercialización, con lo que el impacto global es muy bajo. Si se tratara de industrializar el diseño para una producción en serie, deberían considerarse las normativas de allá donde se quisiera distribuir. Para comercializar un equipo electrónico en Europa, todos los componentes electrónicos que lo forman deben cumplir la directiva RoHS.

\subsection{Gestión de residuos}

Si se tratara de escalar el proyecto a una producción, la disposición de los residuos generados durante el proceso de fabricación y ensamblaje de los inversores es un aspecto crucial a tener en cuenta para mitigar el impacto ambiental. La correcta gestión de residuos electrónicos es fundamental para prevenir la contaminación, así como para evitar la liberación de sustancias tóxicas en el medio ambiente. La implementación de sistemas de reciclaje y la adopción de prácticas de disposición adecuadas pueden ayudar a reducir el impacto ambiental de esta etapa, y esto se debería consultar con los fabricantes y ensambladores que se encarguen de la producción. A día de hoy, la mayoría de empresas del sector cumplen con estándares altos en cuanto a la gestión de los residuos, especialmente en Europa.

\subsection{Transporte}

El transporte de los materiales y componentes utilizados en la fabricación y ensamblaje de los inversores también puede tener un impacto ambiental significativo. Las emisiones de gases de efecto invernadero generadas por los vehículos de transporte son quizás la mayor parte del impacto ambiental generado por este proyecto. Ya que la mayoría de componentes se han pedido a modo de muestras y se han realizado varios pedidos extras, el transporte de los componentes y las placas seguramente ha supuesto una cantidad de emisiones descomunal. Además, la mayoría de componentes y todas las placas vinieron de China, siendo una ruta muy larga que contribuye a la huella de carbono que este proyecto ha dejado.

\subsection{Consumo energético}

Al hablar de consumo energético en este apartado se hace referencia a la electricidad consumida para el diseño y fabricación del prototipo. Es muy difícil cuantificar la energía utilizada ya que no solamente se tienen que tener en cuenta los equipos utilizados de primera mano, si no que sería necesario tener en cuenta el consumo de energía asociado con la fabricación de los componentes electrónicos, la operación de maquinaria y equipos, así como el uso de sistemas de climatización e iluminación en las instalaciones de producción. El proceso de diseño y desarrollo del prototipo también puede requerir el uso de herramientas y \textit{software} que consumen energía eléctrica, como ordenadores, estaciones de trabajo y equipos de prueba.


\newpage
\section{Presupuesto}
\subsection{Costes de ingeniería}

Para estimar los costes de ingeniería, se consulta la tabla salarial \cite{BOE2024}, donde un graduado en ingeniería técnica debería cobrar al menos \textbf{8,8 \euro{}  la hora} por ser del tercer nivel salarial. El tiempo total invertido en ingeniería se puede estimar sabiendo que se trabajó una media de 30 horas a la semana desde septiembre hasta la fecha de entrega, lo que equivale a unas \textbf{1140 horas} de diseño, desarrollo y documentación.

\subsubsection{Desarrollo del control}
De todas las horas invertidas, se estima que un 25\% de las mismas fueron destinadas al estudio y diseño del control. Por lo tanto, se calculan 2508 \euro{} para los costes humanos en este aspecto. Además, se usaron MATLAB, Simulink y PLECS, cuyas licencias cuestan 119 \euro{} \cite{MathWorks2024}, 35 \euro{} \cite{MathWorks2024} y 1400 \euro{} \cite{Plexim2024} respectivamente. En total, los costes para desarrollar el control ascienden a (2508 + 119 + 35 + 1400) \euro{}  = \textbf{4062 \euro{}}.

\subsubsection{Desarrollo del \textit{hardware}}
Se estima que se invirtió un 40\% del tiempo total en el diseño, prototipado y validación del \textit{hardware}, lo que equivale a 4012,8 \euro{} . Para diseñar las PCBs se usó Altium Designer, y una licencia anual para el mismo está situada en los 4425 \euro{} \cite{Altium2024}. Se usó también Solidworks, cuya licencia cuesta unos 2600 \euro{} \cite{GoEngineer2024}. Los costes de desarrollo de \textit{hardware} suman \textbf{8437,8 \euro{}}.

\subsubsection{Desarrollo del \textit{firmware}}
Para desarrollar el \textit{firmware} se dedicó un 20\% del tiempo aproximadamente, y eso se traduce a \textbf{2006,4 \euro{}}. No se usó ningún programa de pago por lo que es todo lo que costaría esta parte del desarrollo.

\subsubsection{Documentación}
La redacción de este trabajo junto al resto de documentación generada llevó el 15\% de tiempo restante, es decir, \textbf{1504,8 \euro{}}. Se usaron Sublime Text y TeXstudio como editores de texto, y MiKTeX como compilador de \LaTeX, que son herramientas \textit{open source} y por tanto gratuitas.

\subsection{Costes de fabricación}

\subsubsection{Placas de circuito impreso}

En el proceso de fabricación de las PCBs para el inversor, se realizaron dos pedidos separados con el proveedor JLCPCB.

\textbf{Primer pedido:}
\begin{itemize}
	\item Fecha de pedido: 2024-02-15
	\item Método de envío: FedEx International Packet
	\item Coste total: 156,26 \euro{} (PCBs de potencia) + 39,98 \euro{} (PCBs de control) + 19,24 \euro{} (envío)
	\item Cantidad: 10 unidades (5 unidades de la PCB de control y 5 unidades de la PCB de potencia)
	\item Descuento: No se tuvo que pagar por la PCB de control gracias a un acuerdo de patrocinio entre JLCPCB y e-Tech Racing.
	\item Coste final: \textbf{174,63 \euro{}}

\end{itemize}

\hspace{1cm}

\textbf{Segundo pedido:}
\begin{itemize}
	\item Fecha de pedido: 2024-03-28
	\item Método de envío: DHL Express Worldwide
	\item Coste total: 119,99 \euro{} (PCBs de potencia) + 39,98 \euro{} (PCBs de control) + 26,58 \euro{} (envío)
	\item Descuento: Se obtuvo un descuento de 140 \$ (129,21 \euro{}) en este pedido.
	\item Cantidad: 10 unidades (5 unidades de la PCB de control y 5 unidades de la PCB de potencia)
	\item Coste final: \textbf{57,32 \euro{}}
\end{itemize}

\hspace{1cm}

\textbf{Total:}
\begin{itemize}
	\item En total, se gastaron \textbf{231,95 \euro{}} en placas.
\end{itemize}
\subsubsection{Componentes electrónicos}
Para obtener el precio de los componentes electrónicos se extraen las listas de materiales de los proyectos generados en Altium Designer.


\subsection{Costes totales}

A continuación se presenta un resumen de los costes totales del proyecto, incluyendo tanto los costes de ingeniería como los costes de fabricación.

\begin{table}[H]
	\centering
	\begin{tabular}{|l|r|}
		\hline
		\textbf{Concepto} & \textbf{Coste (\euro{})} \\
		\hline
		\multicolumn{2}{|c|}{Costes de ingeniería} \\
		\hline
		Desarrollo del control & 4062,00 \\
		Desarrollo del \textit{hardware} & 8437,80 \\
		Desarrollo del \textit{firmware} & 2006,40 \\
		Documentación & 1504,80 \\
		\hline
		\textbf{Total costes de ingeniería} & \textbf{16011} \\
		\hline
		\multicolumn{2}{|c|}{Costes de fabricación} \\
		\hline
		Placas de circuito impreso & 231,95 \\
		Componentes electrónicos & Por determinar \\
		\hline
		\textbf{Total costes de fabricación} & \textbf{Por determinar} \\
		\hline
		\textbf{Coste total del proyecto} & \textbf{Por determinar} \\
		\hline
	\end{tabular}
	\caption{Resumen de los costes totales del proyecto.}
\end{table}


\newpage
\section{Cumplimiento de los objetivos y trabajo futuro}

En esta sección se rescatan los objetivos propuestos al inicio del trabajo y se comenta en qué medida se han logrado alcanzar. Además, se plantean los siguientes pasos en el desarrollo e implementación de este inversor para un vehículo de Formula Student.

\subsection{Cumplimiento de los objetivos}

\subsubsection{Adquirir conocimiento sobre control de motores eléctricos y diseño de convertidores de potencia} 

En el desarrollo de este trabajo se ha abordado con rigurosidad el modelo matemático del PMSM, describiendo analíticamente sus comportamiento y diseñando un control analítico en base a estas ecuaciones. Se han tomado referencias de alta calidad para diseñar el control vectorial y se considera que el algoritmo implementado está a la orden del día. Es cierto que este algoritmo tiene algunas dificultades, como por ejemplo, la regeneración en debilitamiento de campo. Sin embargo, estos problemas no están resueltos de forma analítica por la comunidad científico-técnica, y los inversores de tracción que implementan controles más avanzados lo hacen mediante puntos de operación tabulados, en vez de analíticamente. Otro punto que es necesario remarcar es que se han obviado algunos razonamientos matemáticos y se han elidido formalismos para no sobrecomplicar el análisis. Se ha decidido hacer así para no congestionar la comprensión de lo que realmente es útil para el control de máquinas eléctricas.

En cuanto al diseño de convertidores de potencia, se ha profundizado considerablemente en los aspectos tanto de \textit{hardware} como de la implementación del control en tiempo real. Se ha adquirido un conocimiento amplio y detallado sobre la selección y dimensionamiento de componentes electrónicos en convertidores, así como sobre las técnicas de diseño de PCB y la integración de los diferentes módulos de un accionamiento eléctrico. Además, se ha estudiado exhaustivamente la programación de MCUs para el control en tiempo real, logrando una buena implementación de lo previamente simulado. Sin embargo, hay que tener en cuenta que no se han abordado muchos aspectos del análisis de convertidores como por ejemplo los ensayos de doble pulso, o la descomposición espectral de frecuencias o el análisis de impacto de EMIs debido a la extensión limitada del trabajo.

Se puede afirmar pues, que este objetivo queda cumplido prácticamente en su totalidad.

\subsubsection{Definir unos requisitos para el inversor de tracción ideal para el equipo e-Tech Racing de la UPC-EEBE}

Atendiendo al apartado que los define, se consideran definidos los requisitos del inversor de tracción ideal para e-Tech Racing. Se tomaron en cuenta todos los aspectos relevantes tanto por la normativa como internos del equipo, y se fusionaron en una lista de requisitos. Cumplir este objetivo no es solamente útil para dimensionar el convertidor de este trabajo, si no que también sirve como metodología de análisis para otros aspectos del tren de potencia del monoplaza. Por tanto, se considera más que cumplido este objetivo.

\subsubsection{Diseñar un inversor de tracción en base a esos requisitos}

El diseño del inversor está completado, y se ha verificado en gran medida mediante simulaciones y pruebas de laboratorio. Se ha considerado cada uno de los requisitos establecidos, y se ha procedido con la selección de componentes adecuados, la creación de esquemas eléctricos y el diseño de las PCBs. Se han realizado dos iteraciones de las placas para corregir los errores iniciales. En resumen, este objetivo se ha alcanzado de manera satisfactoria.

\subsubsection{Implementar un control vectorial que permita el control independiente de dos motores con un solo microcontrolador}

AAAAAAAAAAAAAAAAAAAAAAAAAAA


\subsubsection{Evaluar y validar el rendimiento del inversor}

El rendimiento del inversor ha sido evaluado y validado mediante una serie de pruebas en condiciones controladas. Se han realizado varios ensayos para verificar las partes más críticas del convertidor, obteniendo resultados coherentes y relacionados con los cálculos o simulaciones previas. No se ha podido probar el inversor en sus máximas especificaciones eléctricas, ya que no se dispuso de una fuente de alimentación capaz de soportar la potencia completa. De todas formas, los datos recopilados hasta la fecha de entrega del trabajo confirman que el inversor estaría listo para ser probado a sus máximas especificaciones y posteriormente ser integrado en un monoplaza de e-Tech Racing. Por consiguiente, se puede concluir que este objetivo ha sido parcialmente alcanzado.

\subsection{Futuras líneas de trabajo}

A continuación, se destacan las partes específicas del trabajo que el autor considera que necesitan una revisión o mejora.

\subsubsection{Control vectorial}

Como se ha mencionado anteriormente, se es consciente de que el algoritmo propuesto no es capaz de controlar la corriente en algunas situaciones como por ejemplo la regeneración en debilitamiento de campo. Se propone esperar una solución por parte de la comunidad científico-técnica y hasta entonces, limitar la frenada regenerativa a la zona de baja fuerza contraelectromotriz. Otra estrategia sería explorar el control tabulado, con los puntos de operación pre-calculados.

\subsubsection{\textit{Hardware}}

\paragraph{Líneas generales}
\begin{itemize}
	\item Diseñar e integrar una \textit{coldplate}.
	\item Integrar el convertidor en una caja con conectores adecuados para el monoplaza.
	\item Tratar de aumentar la densidad de potencia volumétrica.
\end{itemize}
\paragraph{Placa de potencia}

\begin{itemize}
	\item D1 tiene una especificación de corriente por debajo del valor medido. Debe ser reemplazado por una protección basada en PMOS o por otro \textit{schottky} más adecuado.
	\item Rdis prácticamente no tiene efecto en comparación con R504...R510 y podría eliminarse.
	\item Implementar los condensadores de desacoplo de la conmutación en el \textit{layout}.
	\item R301 puede tener un valor más bajo.
	\item La mayoría de los condensadores DNP son realmente necesarios.
	\item D501 falló una vez, aunque la causa sigue siendo desconocida.
	\item R501 debería tener un valor más grande.
	\item R511 y R512 deben tener una tolerancia pequeña, y esto debe especificarse en el esquemático.
	\item Los condensadores de 10 $\mu$F 50 V 0805 son caros y deberían reemplazarse por 10 $\mu$F 50 V 1206 o 10 $\mu$F 50 V 1210.
	\item Implementar la protección de desaturación aprovechando que el \textit{gate driver} escogido está habilitado para ello.
\end{itemize}

\paragraph{Placa de control}

\begin{itemize}
	\item DCDC101 no se ha probado todavía.
	\item L101 tiene una especificación de corriente muy baja. Debería aguantar al menos 3A.
	\item Q101 y el USB en general no se han probado aún.
	\item El punto del MCU en la serigrafía podría ser confuso. Verificar la orientación con el montaje, e indicar mejor en la serigrafía.
	\item Se debería añadir protección contra sobrevoltaje de 3.3 V a todos los pines del MCU que no sean tolerantes a 5 V.
	\item La mayoría, si no todas, las resitencias de 15 $\Omega$ podrían ser de 0 $\Omega$ o incluso puentes de soldadura.
	\item Los condensadores de 10 $\mu$F 50 V 0805 son caros y deberían reemplazarse por 10 $\mu$F 50 V 1206 o 10 $\mu$F 50 V 1210.
\end{itemize}

\subsubsection{\textit{Firmware}}
AAAAAAAAAAAAAAAAAAAAAAA